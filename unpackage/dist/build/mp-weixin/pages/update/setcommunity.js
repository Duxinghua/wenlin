(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/update/setcommunity"],{"3f2a":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){n.e("components/nodata/nodata").then(function(){return resolve(n("b641"))}.bind(null,n)).catch(n.oe)},o=function(){n.e("components/struggler-navigationCustom/navigation-custom").then(function(){return resolve(n("e7f2"))}.bind(null,n)).catch(n.oe)},a={data:function(){return{config:{title:"添加小区",bgcolor:"white",fontcolor:"rgba(51, 51, 51, 1)",type:1,transparent:!1,linear:!1,share:!1},scrollTop:0,scrollMaxHeight:200,searchFlag:!1,searchValue:"",list:[],opencommunity:!1,setcommunity:!1,setcommunityObj:{},community:"",building:"",unit:1,room:"",pickerId:!1,picker:[{value:1,label:"业主"},{value:2,label:"亲友"},{value:3,label:"租客"}],pickerValue:0,selectIndex:1,setcommunityType:1,setcommunityValue:"业主",textread:"《问邻服务协议及隐私政策》",openCommunity:!1,mobile:"",communityAddress:"",communityTitle:"",CustomBar:this.CustomBar,noDataFlag:!1,tips:"附近暂无小区，可以开通您所在的小区"}},onPageScroll:function(t){this.scrollTop=t.scrollTop},mounted:function(){this.mobile=t.getStorageSync("mobile"),this.getList()},methods:{getList:function(){var e=this,n=new Promise((function(e,n){t.getStorageSync("longitude")||t.getLocation({success:function(e){t.setStorageSync("latitude",e.latitude),t.setStorageSync("longitude",e.longitude)},fail:function(e){console.log(e),t.showToast({title:"您未开通地图授权，请输入地址",icon:"none",duration:2e3})}}),e()}));n.then((function(n){var i=e;t.getStorageSync("longitude")&&i.Api.getNearCommunity({latitude:t.getStorageSync("latitude"),longitude:t.getStorageSync("longitude")}).then((function(t){1==t.code&&(i.list=t.data,e.opencommunity=!0,i.list.length?i.noDataFlag=!1:i.noDataFlag=!0,e.tips="附近暂无小区，可以开通您所在的小区")}))}))},communityTitleInput:function(t){},createCommuntiy:function(){t.navigateTo({url:"../update/openingcommunity"})},setClose:function(){this.openCommunity=!1},getPhoneNumber:function(e){var n=this;console.log(e);var i=e.detail,o=i.encryptedData,a=i.iv;this.Api.setUserPhoneBySecret({encrypted_data:o,iv:a}).then((function(e){1==e.code&&(n.mobile=e.data,t.setStorageSync("mobile",e.data))}))},getAddress:function(){var e=this,n=new Promise((function(e,n){t.getStorageSync("longitude")||t.getLocation({success:function(e){t.setStorageSync("latitude",e.latitude),t.setStorageSync("longitude",e.longitude)},fail:function(t){console.log(t)}}),e()}));n.then((function(n){t.getStorageSync("longitude")?t.chooseLocation({latitude:t.getStorageSync("latitude"),longitude:t.getStorageSync("longitude"),success:function(t){e.communityAddress=t.address}}):t.showToast({title:"您未开通地图授权，请输入地址",duration:2e3})}))},communityAddressInput:function(t){this.communityAddress=t.detail.value},openCommunityHandler:function(){this.communityTitle?this.communityAddress?this.mobile?this.Api.communityOpening({title:this.communityTitle,address:this.communityAddress,contact_phone:this.mobile}).then((function(e){1==e.code?t.showToast({title:e.msg,duration:2e3,success:function(){t.navigateBack({delta:1})}}):t.showToast({title:e.msg,duration:2e3})})):t.showToast({title:"请输入手机号",duration:2e3}):t.showToast({title:"请输入小区地址",duration:2e3}):t.showToast({title:"请输入小区名",icon:"none",duration:2e3})},gosecret:function(){t.navigateTo({url:"/pages/update/secret"})},openPicker:function(t){this.pickerId=!0},closePicker:function(t){this.pickerId=!1},pickerChange:function(t){var e=t.detail.value[0];this.pickerValue=e},pickerClick:function(t){this.setcommunityType=this.picker[this.pickerValue].value,this.setcommunityValue=this.picker[this.pickerValue].label,this.pickerId=!1},selHandler:function(e){this.setcommunityObj=e,this.community=e.title;var n=t.getStorageSync("all_community"),i=!1;if(n.map((function(t){t.title==e.title&&(i=!0)})),i)t.showToast({title:"您已加入过本小区，不能重复加入",icon:"none",duration:2e3});else{var o=t.getStorageSync("maxJoin");o!=n.length?this.setcommunity=!0:t.showToast({title:"您最多只能加入"+o+"个小区",icon:"none",duration:2e3})}},buildingInput:function(t){this.building=t.detail.value.replace(/[^a-z|0-9]/gi,"")},unitInput:function(t){this.unit=t.detail.value.replace(/[^a-z|0-9]/gi,"")},roomInput:function(t){this.room=t.detail.value.replace(/[^a-z|0-9]/gi,"")},setcommunityClose:function(t){this.setcommunity=!1},customConduct:function(t){console.log(t)},searchInput:function(){this.searchFlag=!0,this.opencommunity=!1,this.search()},searchClear:function(t){this.searchValue="",this.list=[],this.opencommunity=!1,this.searchFlag=!1},search:function(){var e=this;if(this.searchValue){var n={title:this.searchValue};this.Api.searchCommunity(n).then((function(t){1==t.code&&(e.list=t.data,e.opencommunity=!0,e.list.length?e.noDataFlag=!1:e.noDataFlag=!0,e.tips="没有搜索到您要加入的小区")}))}else t.showToast({title:"请输入搜索小区",icon:"none",duration:2e3})},setcommunityHandler:function(){if(this.building)if(this.unit)if(this.room){var e={building:this.building,unit:this.unit,community_id:this.setcommunityObj.community_id,room:this.room,type:this.setcommunityType},n=t.getStorageSync("all_community"),i={community_id:e.community_id,title:this.community,committee_id:0,total:0};n.push(i),this.Api.setUserCommunityInfo(e).then((function(e){1==e.code&&(t.setStorageSync("all_community",n),t.showToast({title:e.msg,duration:2e3,success:function(){t.navigateBack({delta:1})}}))}))}else t.showToast({icon:"none",title:"请输入门牌号"});else t.showToast({icon:"none",title:"请输入单元号"});else t.showToast({icon:"none",title:"请输入楼栋号"})}},components:{navigationCustom:o,Nodata:i}};e.default=a}).call(this,n("543d")["default"])},4113:function(t,e,n){"use strict";n.r(e);var i=n("4600"),o=n("b14f");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("cdd8");var c,u=n("f0c5"),s=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"522281ea",null,!1,i["a"],c);e["default"]=s.exports},4600:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var o=function(){var t=this,e=t.$createElement;t._self._c},a=[]},"5db9":function(t,e,n){"use strict";(function(t){n("4038");i(n("66fd"));var e=i(n("4113"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"676c":function(t,e,n){},b14f:function(t,e,n){"use strict";n.r(e);var i=n("3f2a"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},cdd8:function(t,e,n){"use strict";var i=n("676c"),o=n.n(i);o.a}},[["5db9","common/runtime","common/vendor"]]]);